/*!
ModalConfirm popup modal confirmation-dialog
Version 2.1
Copyright (C) 2014-2015 Tom Phane
Licensed under the GNU Affero GPL license v.3, or at the distributor's discretion, a later version
*/
(function($){$.extend({modalconfirm:new function(){this.defaults={confirmBtnID:"mc_conf",denyBtnID:"mc_deny",doCheck:null,onCheckFail:null,onConfirm:null,onDeny:null,overlayID:"mc_overlay",popupID:null,preShow:null,seeButtons:"both",showTarget:null,confirmCss:null,denyCss:null};this.construct=function(c){var d=$.extend({},$.modalconfirm.defaults,c||{});this.each(function(){$(this).bind("click",d,a)});return this};function a(g){var e=g.data,d=g.currentTarget;if(!$.isFunction(e.doCheck)||e.doCheck.call(this)){g.stopImmediatePropagation();g.preventDefault();var l=$("#"+e.overlayID),c=(e.popupID)?$("#"+e.popupID):l.children(":first");var k=c.find("#"+e.confirmBtnID);if(e.seeButtons!="deny"){k.click(function(o){o.stopImmediatePropagation();b(l,c,e);var n;if($.isFunction(e.onConfirm)){n=e.onConfirm.call(this,d,c)}else{n=(e.onConfirm===null||e.onConfirm!==false)}if(n){var p=$(d);p.unbind("click",a);d.click();p.bind("click",e,a)}})}else{if("display" in k[0].style){e.confirmCss=k[0].style.display}else{e.confirmCss=""}k[0].style.display="none"}k=c.find("#"+e.denyBtnID);if(e.seeButtons!="confirm"){k.click(function(n){n.stopImmediatePropagation();n.preventDefault();b(l,c,e);$.isFunction(e.onDeny)&&e.onDeny.call(this,d)})}else{if("display" in k[0].style){e.denyCss=k[0].style.display}else{e.denyCss=""}k[0].style.display="none"}$.isFunction(e.preShow)&&e.preShow.call(this,d,c);var f=c.height();var i=c.width();var m=-c.outerHeight()/2;var h=-c.outerWidth()/2;l.css("display","block");c.css({"margin-top":m+"px","margin-left":h+"px",height:f+"px",width:i+"px",display:"block"})}else{var j;if(e.onCheckFail){if($.isFunction(e.onCheckFail)){j=!e.onCheckFail.call(this,d)}else{j=(e.onCheckFail===false)}}else{j=true}if(j){$.isFunction(e.onDeny)&&e.onDeny.call(this,d);g.stopImmediatePropagation();g.preventDefault()}}}function b(c,e,d){e.css({display:"none"});c.css({display:"none"});e.find("#"+d.confirmBtnID)[0].style.display=d.confirmCss;d.confirmCss=null;e.find("#"+d.denyBtnID)[0].style.display=d.denyCss;d.denyCss=null}this.show=function(k){var d=$.extend({},$.modalconfirm.defaults,k||{}),i=$("#"+d.overlayID),c=(d.popupID)?$("#"+d.popupID):i.children(":first");var h=c.find("#"+d.confirmBtnID);if(d.seeButtons!="deny"){h.click(function(l){l.stopImmediatePropagation();b(i,c,d);$.isFunction(d.onConfirm)&&d.onConfirm.call(this,d.showTarget,c)})}else{if("display" in h[0].style){d.confirmCss=h[0].style.display}else{d.confirmCss=""}h[0].style.display="none"}h=c.find("#"+d.denyBtnID);if(d.seeButtons!="confirm"){h.click(function(l){l.stopImmediatePropagation();l.preventDefault();b(i,c,d);$.isFunction(d.onDeny)&&d.onDeny.call(this,d.showTarget)})}else{if("display" in h[0].style){d.denyCss=h[0].style.display}else{d.denyCss=""}h[0].style.display="none"}$.isFunction(d.preShow)&&d.preShow.call(this,d.showTarget,c);var e=c.height();var g=c.width();var j=-c.outerHeight()/2;var f=-c.outerWidth()/2;i.css("display","block");c.css({"margin-top":j+"px","margin-left":f+"px",height:e+"px",width:g+"px",display:"block"})}}});$.fn.extend({modalconfirm:$.modalconfirm.construct})})(jQuery);