/*!
ModalConfirm popup modal confirmation-dialog
Version 2.2
Copyright (C) 2014-2016 Tom Phane
Licensed under the GNU Affero GPL license v.3, or at the distributor's discretion, a later version
*/
(function($){$.extend({modalconfirm:new function(){this.defaults={confirmBtnID:"mc_conf",denyBtnID:"mc_deny",doCheck:null,onCheckFail:null,onConfirm:null,onDeny:null,overlayID:"mc_overlay",popupID:null,preShow:null,seeButtons:"both",showTarget:null,confirmCss:null,denyCss:null};this.construct=function(c){var d=$.extend({},$.modalconfirm.defaults,c||{});this.each(function(){$(this).bind("click",d,a)});return this};function a(f){var e=f.data,d=f.currentTarget;if(!$.isFunction(e.doCheck)||e.doCheck.call(this)){f.stopImmediatePropagation();f.preventDefault();var j=$("#"+e.overlayID),c=(e.popupID)?$("#"+e.popupID):j.children(":first");var i=c.find("#"+e.confirmBtnID);if(e.seeButtons!="deny"){i.click(function(m){m.stopImmediatePropagation();b(j,c,e);var l;if($.isFunction(e.onConfirm)){l=e.onConfirm.call(this,d,c)}else{l=(e.onConfirm===null||e.onConfirm!==false)}if(l){var n=$(d);n.unbind("click",a);d.click();n.bind("click",e,a)}})}else{if("display" in i[0].style){e.confirmCss=i[0].style.display}else{e.confirmCss=""}i[0].style.display="none"}i=c.find("#"+e.denyBtnID);if(e.seeButtons!="confirm"){i.click(function(l){l.stopImmediatePropagation();l.preventDefault();b(j,c,e);$.isFunction(e.onDeny)&&e.onDeny.call(this,d)})}else{if("display" in i[0].style){e.denyCss=i[0].style.display}else{e.denyCss=""}i[0].style.display="none"}$.isFunction(e.preShow)&&e.preShow.call(this,d,c);j.css("display","block");var k=-c.outerHeight()/2;var g=-c.outerWidth()/2;c.css({"margin-top":k+"px","margin-left":g+"px",display:"block"})}else{var h;if(e.onCheckFail){if($.isFunction(e.onCheckFail)){h=!e.onCheckFail.call(this,d)}else{h=(e.onCheckFail===false)}}else{h=true}if(h){$.isFunction(e.onDeny)&&e.onDeny.call(this,d);f.stopImmediatePropagation();f.preventDefault()}}}function b(c,e,d){e.css({display:"none"});c.css({display:"none"});e.find("#"+d.confirmBtnID)[0].style.display=d.confirmCss;d.confirmCss=null;e.find("#"+d.denyBtnID)[0].style.display=d.denyCss;d.denyCss=null}this.show=function(k){var d=$.extend({},$.modalconfirm.defaults,k||{}),i=$("#"+d.overlayID),c=(d.popupID)?$("#"+d.popupID):i.children(":first");var h=c.find("#"+d.confirmBtnID);if(d.seeButtons!="deny"){h.click(function(l){l.stopImmediatePropagation();b(i,c,d);$.isFunction(d.onConfirm)&&d.onConfirm.call(this,d.showTarget,c)})}else{if("display" in h[0].style){d.confirmCss=h[0].style.display}else{d.confirmCss=""}h[0].style.display="none"}h=c.find("#"+d.denyBtnID);if(d.seeButtons!="confirm"){h.click(function(l){l.stopImmediatePropagation();l.preventDefault();b(i,c,d);$.isFunction(d.onDeny)&&d.onDeny.call(this,d.showTarget)})}else{if("display" in h[0].style){d.denyCss=h[0].style.display}else{d.denyCss=""}h[0].style.display="none"}$.isFunction(d.preShow)&&d.preShow.call(this,d.showTarget,c);i.css("display","block");var e=c.height();var g=c.width();var j=-c.outerHeight()/2;var f=-c.outerWidth()/2;c.css({"margin-top":j+"px","margin-left":f+"px",height:e+"px",width:g+"px",display:"block"})}}});$.fn.extend({modalconfirm:$.modalconfirm.construct})})(jQuery);